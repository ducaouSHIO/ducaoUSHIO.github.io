<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¡ƒå¤œæœ”æ­Œå•</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        /* è‡ªå®šä¹‰é¼ æ ‡æŒ‡é’ˆ */
        body {
            cursor: url('ğŸ‘.png'), auto;
        }

        /* èƒŒæ™¯æ ·å¼ */
        body {
            background: linear-gradient(
                rgba(164, 119, 190, 0.7),
                rgba(195, 111, 132, 0.7)
            ),
            repeating-conic-gradient(
                rgba(0, 0, 0, 0.3) 0% 25%,
                rgba(255, 255, 255, 0.3) 0% 50%
            ) 0% 0% / 80px 80px;
            background-blend-mode: multiply;
            min-height: 100vh;
            padding: 20px;
        }

        /* ä¸»å®¹å™¨æ ·å¼ */
        .main-container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

        /* è¡¨æ ¼æ ·å¼ */
        .song-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .song-table th {
            background: linear-gradient(rgba(164,119,190,0.1), rgba(195,111,132,0.1));
            padding: 15px;
            border-bottom: 2px solid #e0e0e0;
        }
        .song-table td {
            padding: 12px;
            border-bottom: 1px solid #f0f0f0;
            transition: background 0.2s;
        }
        .song-table tr:hover td {
            background: rgba(164, 119, 190, 0.05);
        }

        /* åˆ†é¡µæŒ‰é’® */
        .pagination-btn {
            margin: 0 4px;
            padding: 6px 12px;
            border: 1px solid rgba(164,119,190,0.3);
            border-radius: 5px;
            transition: all 0.3s;
        }
        .pagination-btn.active {
            background: linear-gradient(rgba(164,119,190,0.8), rgba(195,111,132,0.8));
            color: white;
            border-color: transparent;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- æ ‡é¢˜éƒ¨åˆ† -->
        <h1 class="text-center mb-4" style="color: #6b446b; font-family: 'Microsoft YaHei'">
            ğŸ‘ æ¡ƒå¤œæœ”æ­Œå• ğŸ‘
        </h1>

        <!-- æœç´¢æ¡† -->
        <div class="search-box mb-4">
            <input 
                type="text" 
                id="searchInput" 
                placeholder="è¾“å…¥æ­Œåæˆ–æ­Œæ‰‹..." 
                class="form-control form-control-lg"
                style="border-radius: 25px"
            >
        </div>

        <!-- åˆ†é¡µæ§ä»¶ -->
        <div id="pagination" class="d-flex justify-content-center mb-4"></div>

        <!-- æ­Œå•è¡¨æ ¼ -->
        <table class="song-table">
            <thead>
                <tr>
                    <th>æ­Œæ›²åç§°</th>
                    <th>æ¼”å”±è€…</th>
                </tr>
            </thead>
            <tbody id="songList">
                <!-- åŠ¨æ€å†…å®¹ -->
            </tbody>
        </table>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    
    <script>
        // é…ç½®é¡¹
        const CONFIG = {
            fileName: 'é˜¿æ¡ƒå”±è¿‡çš„æ­Œ2.0.xlsx',
            pageSize: 50,
            maxPages: 20
        };

        // åº”ç”¨çŠ¶æ€
        let app = {
            allSongs: [],
            filteredSongs: [],
            currentPage: 1
        };

        // åˆå§‹åŒ–åº”ç”¨
        function init() {
            loadData()
                .then(processData)
                .then(initEvents)
                .catch(handleError);
        }

        // åŠ è½½Excelæ•°æ®
        async function loadData() {
            try {
                const response = await fetch(CONFIG.fileName);
                if (!response.ok) throw new Error(`æ–‡ä»¶åŠ è½½å¤±è´¥ (${response.status})`);
                return response.arrayBuffer();
            } catch (e) {
                throw new Error(`æ— æ³•åŠ è½½æ–‡ä»¶ï¼š${e.message}`);
            }
        }

        // å¤„ç†æ•°æ®
        function processData(buffer) {
            try {
                const workbook = XLSX.read(new Uint8Array(buffer), { type: 'array' });
                const sheet = workbook.Sheets[workbook.SheetNames[0]];
                const rawData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
                
                app.allSongs = rawData
                    .filter(row => row.length >= 2)
                    .map(row => ({
                        name: String(row[0]).trim() || 'æœªå‘½åæ­Œæ›²',
                        artist: String(row[1]).trim() || 'æœªçŸ¥æ­Œæ‰‹'
                    }));
                
                if (app.allSongs.length === 0) throw new Error('æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆæ­Œæ›²æ•°æ®');
                
                app.filteredSongs = [...app.allSongs];
                render();
            } catch (e) {
                throw new Error(`æ•°æ®å¤„ç†å¤±è´¥ï¼š${e.message}`);
            }
        }

        // æ¸²æŸ“å†…å®¹
        function render() {
            renderTable();
            renderPagination();
        }

        // æ¸²æŸ“è¡¨æ ¼
        function renderTable() {
            const start = (app.currentPage - 1) * CONFIG.pageSize;
            const end = start + CONFIG.pageSize;
            const data = app.filteredSongs.slice(start, end);
            
            document.getElementById('songList').innerHTML = data
                .map(song => `
                    <tr>
                        <td class="copyable">${song.name}</td>
                        <td>${song.artist}</td>
                    </tr>
                `).join('');
            
            initCopy();
        }

        // æ¸²æŸ“åˆ†é¡µ
        function renderPagination() {
            const total = Math.min(
                Math.ceil(app.filteredSongs.length / CONFIG.pageSize),
                CONFIG.maxPages
            );
            
            document.getElementById('pagination').innerHTML = Array
                .from({ length: total }, (_, i) => i + 1)
                .map(page => `
                    <button 
                        class="pagination-btn ${page === app.currentPage ? 'active' : ''}"
                        data-page="${page}"
                    >
                        ${page}
                    </button>
                `).join('');
        }

        // åˆå§‹åŒ–äº‹ä»¶
        function initEvents() {
            // åˆ†é¡µç‚¹å‡»
            document.getElementById('pagination').addEventListener('click', e => {
                if (e.target.tagName === 'BUTTON') {
                    app.currentPage = parseInt(e.target.dataset.page);
                    render();
                }
            });

            // æœç´¢åŠŸèƒ½
            document.getElementById('searchInput').addEventListener('input', e => {
                const term = e.target.value.toLowerCase().trim();
                app.filteredSongs = app.allSongs.filter(song => 
                    song.name.toLowerCase().includes(term) ||
                    song.artist.toLowerCase().includes(term)
                );
                app.currentPage = 1;
                render();
            });
        }

        // å¤åˆ¶åŠŸèƒ½
        function initCopy() {
            document.querySelectorAll('.copyable').forEach(td => {
                td.addEventListener('click', () => {
                    navigator.clipboard.writeText(td.textContent)
                        .then(() => alert(`å·²å¤åˆ¶ï¼š${td.textContent}`))
                        .catch(() => alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ£€æŸ¥æƒé™è®¾ç½®'));
                });
            });
        }

        // é”™è¯¯å¤„ç†
        function handleError(error) {
            console.error(error);
            alert(`é”™è¯¯ï¼š${error.message}\nè¯·æ£€æŸ¥æ§åˆ¶å°è·å–è¯¦ç»†ä¿¡æ¯`);
        }

        // å¯åŠ¨åº”ç”¨
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>